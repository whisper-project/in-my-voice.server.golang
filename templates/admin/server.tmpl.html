{{ define "admin/server.tmpl.html" }}
<!--
  ~ Copyright 2025 Daniel C. Brotsky. All rights reserved.
  ~ All the copyrighted work in this repository is licensed under the
  ~ GNU Affero General Public License v3, reproduced in the LICENSE file.
  -->

<!DOCTYPE html>
<html lang="en">
<head>
    {{ template "admin/header.tmpl.html" }}
    <title>InMyVoice User Administration</title>
</head>
<body>
<h1>InMyVoice - Server Administration</h1>
<p style="color: red;">{{ .Message }}</p>
<h2>Admins</h2>
<table>
    <thead>
        <tr>
            <th>Email</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    {{ range .Users }}
        <tr>
            <td>{{ .Email }}</td>
            <td><a href="?edit={{ .Id }}">Edit</a>, <a href="?delete={{ .Id }}">Delete</a></td>
        </tr>
    {{ end }}
    </tbody>
</table>
{{ if .Edit }}
    <h3>Edit Admin</h3>
    <form action="./server" method="POST">
        <input type="hidden" name="op" value="edit" />
        <input type="hidden" name="id" value="{{ .Edit.Id }}" />
        <div class="form-control width-500">
            <label for="email">Email:</label>
            <input type="text" id="email" name="email" size="50" value="{{ .Edit.Email }}" required />
        </div>
        <div class="form-control width-500">
            <button type="submit">Save Changes</button>
            <button type="button" onclick="window.location.href='./server'">Cancel</button>
        </div>
    </form>
{{ else }}
    <h3>Add Admin</h3>
    <form action="./server" method="POST">
        <input type="hidden" name="op" value="add" />
        <input type="hidden" name="id" value="" />
        <div class="form-control width-500">
            <label for="email">Email:</label>
            <input type="text" id="email" name="email" size="50" value="" required />
        </div>
        <div class="form-control width-500">
            <button type="submit">Save Changes</button>
            <button type="button" onclick="window.location.href='./server'">Cancel</button>
        </div>
    </form>
{{ end }}
<h2>Policies</h2>
<form action="./server" method="POST">
    <input type="hidden" name="op" value="policies" />
    <div class="form-control width-325">
        <label for="target">Collect data from:</label>
        <select id="target" name="target">
            <option value="study"
                    {{if (eq .Policies.Users "study") }}selected{{ end }}>Study Participants</option>
            <option value="all"
                    {{if (eq .Policies.Users "all") }}selected{{ end }}>All Users</option>
        </select>
    </div>
    {{ if (eq .Policies.Users "all") }}
        <div class="form-control width-325">
            <label for="anon">Typed line data from non-study users is:</label>
            <select id="anon" name="anon">
                <option value="anon"
                        {{if (eq .Policies.Users "anon") }}selected{{ end }}>Anonymized</option>
                <option value="profile"
                        {{if (eq .Policies.Users "profile") }}selected{{ end }}>Individualized</option>
            </select>
        </div>
        <div class="form-control width-325">
            <label for="pool">Phrase data from non-study users is:</label>
            <select id="pool" name="pool">
                <option value="pool"
                        {{if (eq .Policies.Users "pool") }}selected{{ end }}>Pooled</option>
                <option value="separate"
                        {{if (eq .Policies.Users "separate") }}selected{{ end }}>Separate</option>
            </select>
        </div>
    {{ end }}
    <div class="form-control width-325">
        <button type="submit">Generate</button>
        <button type="button" onclick="window.location.href=''">Cancel</button>
    </div>
</form>

{{ template "admin/footer.tmpl.html" }}
</body>
</html>
{{ end }}
